{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**TABLE-1**\n",
    "\n",
    "*1. Write a query to retrieve all shoe names and their corresponding\n",
    "prices for men's shoes:*\n",
    "\n",
    "SELECT \"Shoe Name\", Price\n",
    "\n",
    "FROM ShoeInformation\n",
    "\n",
    "WHERE Category = 'Men';\n",
    "\n",
    "\\`\n",
    "\n",
    "*2. Write a query to retrieve the number of different colors available\n",
    "for each category:*\n",
    "\n",
    "SELECT Category, COUNT(DISTINCT \"Color 1\", \"Color 2\", \"Color 3\", \"Color\n",
    "4\", \"Color 5\") AS \"Number of Colors\"\n",
    "\n",
    "FROM SizeColorInformation\n",
    "\n",
    "GROUP BY Category;\n",
    "\n",
    "*3. Write a query to find the most expensive men's shoe:*\n",
    "\n",
    "SELECT \"Shoe Name\", Price\n",
    "\n",
    "FROM ShoeInformation\n",
    "\n",
    "WHERE Category = 'Men'\n",
    "\n",
    "ORDER BY Price DESC\n",
    "\n",
    "LIMIT 1;\n",
    "\n",
    "*4. Write a query to find the cheapest women's shoe in a specific color\n",
    "(e.g., 'Black'):*\n",
    "\n",
    "SELECT \"Shoe Name\", Price\n",
    "\n",
    "FROM ShoeInformation\n",
    "\n",
    "WHERE Category = 'Women' AND (\"Color 1\" = 'Black' OR \"Color 2\" = 'Black'\n",
    "OR \"Color 3\" = 'Black' OR \"Color 4\" = 'Black' OR \"Color 5\" = 'Black')\n",
    "\n",
    "ORDER BY Price\n",
    "\n",
    "LIMIT 1;\n",
    "\n",
    "*5. Write a query to retrieve all shoe names and their corresponding\n",
    "prices for men's shoes:*\n",
    "\n",
    "SELECT \"Shoe Name\", Price\n",
    "\n",
    "FROM ShoeInformation\n",
    "\n",
    "WHERE Category = 'Men';\n",
    "\n",
    "**TABLE-2**\n",
    "\n",
    "*1. Write a query that retrieves the count of sizes for all styles:*\n",
    "\n",
    "SELECT \"Style Code\", COUNT(DISTINCT \"Size\") AS \"Count of Sizes\"\n",
    "\n",
    "FROM SizeColorInformation\n",
    "\n",
    "GROUP BY \"Style Code\";\n",
    "\n",
    "*2. Write a query to list all styles with their associated colors:*\n",
    "\n",
    "SELECT DISTINCT \"Style Code\", \"Color 1\", \"Color 2\", \"Color 3\", \"Color\n",
    "4\", \"Color 5\"\n",
    "\n",
    "FROM SizeColorInformation;\n",
    "\n",
    "*3. Write a query to find styles that have more than one color:*\n",
    "\n",
    "SELECT \"Style Code\"\n",
    "\n",
    "FROM SizeColorInformation\n",
    "\n",
    "GROUP BY \"Style Code\"\n",
    "\n",
    "HAVING COUNT(DISTINCT \"Color 1\", \"Color 2\", \"Color 3\", \"Color 4\", \"Color\n",
    "5\") \\> 1;\n",
    "\n",
    "*4. Write a query to find the count of sizes available for each color\n",
    "for a specific style code:*\n",
    "\n",
    "SELECT \"Style Code\", \"Color\", COUNT(DISTINCT \"Size\") AS \"Count of Sizes\"\n",
    "\n",
    "FROM SizeColorInformation\n",
    "\n",
    "WHERE \"Style Code\" = 'your_specific_style_code'\n",
    "\n",
    "GROUP BY \"Style Code\", \"Color\";\n",
    "\n",
    "*5. Write a query to find styles that have a specific color:*\n",
    "\n",
    "SELECT DISTINCT \"Style Code\"\n",
    "\n",
    "FROM SizeColorInformation\n",
    "\n",
    "WHERE \"Color 1\" = 'your_specific_color'\n",
    "\n",
    "OR \"Color 2\" = 'your_specific_color'\n",
    "\n",
    "OR \"Color 3\" = 'your_specific_color'\n",
    "\n",
    "OR \"Color 4\" = 'your_specific_color'\n",
    "\n",
    "OR \"Color 5\" = 'your_specific_color';\n",
    "\n",
    "**TABLE-3**\n",
    "\n",
    "*1. Write a query that calculates the average comfort rating for a\n",
    "specific product based on its reviews:*\n",
    "\n",
    "SELECT \"Product Code\", AVG(\"Comfort\") AS \"Average Comfort Rating\"\n",
    "\n",
    "FROM Reviews\n",
    "\n",
    "WHERE \"Product Code\" = 'your_specific_product_code'\n",
    "\n",
    "GROUP BY \"Product Code\";\n",
    "\n",
    "*2. Write a query to retrieve products with high star ratings (e.g., 4\n",
    "stars or above):*\n",
    "\n",
    "SELECT \"Product Code\", \"Product Name\", \"Star Rating\"\n",
    "\n",
    "FROM Reviews\n",
    "\n",
    "WHERE \"Star Rating\" \\>= 4;\n",
    "\n",
    "*3. Write a query that counts the number of reviews for each product:*\n",
    "\n",
    "SELECT \"Product Code\", COUNT(\\*) AS \"Number of Reviews\"\n",
    "\n",
    "FROM Reviews\n",
    "\n",
    "GROUP BY \"Product Code\";\n",
    "\n",
    "*4. Write a query to retrieve products that have a quantified\n",
    "durability/quality/performance rating above a certain threshold (e.g.,\n",
    "above 7):*\n",
    "\n",
    "SELECT \"Product Code\", \"Product Name\", \"Durability/Quality/Performance\"\n",
    "\n",
    "FROM Reviews\n",
    "\n",
    "WHERE \"Durability/Quality/Performance\" \\> 7;\n",
    "\n",
    "*5. Write a query that calculates the average comfort rating for each\n",
    "size:*\n",
    "\n",
    "SELECT \"Size\", AVG(\"Comfort\") AS \"Average Comfort Rating\"\n",
    "\n",
    "FROM Reviews\n",
    "\n",
    "GROUP BY \"Size\";\n",
    "\n",
    "**7 Join SQL Queries using all 3 tables:**\n",
    "\n",
    "*1. Write a query that finds the top-rated men's shoes along with their\n",
    "sizes from \"Table1\" and \"Table3\":*\n",
    "\n",
    "SELECT t1.\"Shoe Name\", t3.\"Size\", t3.\"Star Rating\"\n",
    "\n",
    "FROM Table1 t1\n",
    "\n",
    "JOIN Table3 t3 ON t1.\"Product Code\" = t3.\"Product Code\"\n",
    "\n",
    "WHERE t1.\"Category\" = 'Men'\n",
    "\n",
    "ORDER BY t3.\"Star Rating\" DESC\n",
    "\n",
    "LIMIT 1;\n",
    "\n",
    "*2. Write a query that calculates the average comfort rating for each\n",
    "category from \"Table1\" and \"Table3\":*\n",
    "\n",
    "SELECT t1.\"Category\", AVG(t3.\"Comfort\") AS \"Average Comfort Rating\"\n",
    "\n",
    "FROM Table1 t1\n",
    "\n",
    "JOIN Table3 t3 ON t1.\"Product Code\" = t3.\"Product Code\"\n",
    "\n",
    "GROUP BY t1.\"Category\";\n",
    "\n",
    "*3. Write a query that identifies products with a\n",
    "durability/quality/performance rating higher than the average from\n",
    "\"Table1\" and \"Table3\":*\n",
    "\n",
    "SELECT t1.\"Shoe Name\", t3.\"Durability/Quality/Performance\"\n",
    "\n",
    "FROM Table1 t1\n",
    "\n",
    "JOIN Table3 t3 ON t1.\"Product Code\" = t3.\"Product Code\"\n",
    "\n",
    "WHERE t3.\"Durability/Quality/Performance\" \\> (\n",
    "\n",
    "SELECT AVG(\"Durability/Quality/Performance\")\n",
    "\n",
    "FROM Table3\n",
    "\n",
    ");\n",
    "\n",
    "*4. Write a subquery that finds products with comfort ratings above the\n",
    "average comfort rating using \"Table1\" and \"Table3\":*\n",
    "\n",
    "SELECT \"Product Code\", \"Comfort\"\n",
    "\n",
    "FROM Table3\n",
    "\n",
    "WHERE \"Comfort\" \\> (\n",
    "\n",
    "SELECT AVG(\"Comfort\")\n",
    "\n",
    "FROM Table3\n",
    "\n",
    ");\n",
    "\n",
    "*5. Write a query that joins Table 1 and Table 2 using the \"Style\n",
    "code/Product code\" column, allowing you to retrieve shoe information\n",
    "along with product details:*\n",
    "\n",
    "SELECT t1.\\*, t2.\\*\n",
    "\n",
    "FROM Table1 t1\n",
    "\n",
    "JOIN Table2 t2 ON t1.\"Style code/Product code\" = t2.\"Style code/Product\n",
    "code\";\n",
    "\n",
    "*6. Write a query that identifies products with a star rating above the\n",
    "average star rating for their respective size:*\n",
    "\n",
    "SELECT t3.\"Product Code\", t3.\"Star Rating\", t3.\"Size\"\n",
    "\n",
    "FROM Table3 t3\n",
    "\n",
    "WHERE t3.\"Star Rating\" \\> (\n",
    "\n",
    "SELECT AVG(\"Star Rating\")\n",
    "\n",
    "FROM Table3\n",
    "\n",
    "WHERE t3.\"Size\" = \"Size\"\n",
    "\n",
    ");\n",
    "\n",
    "*7. Write a query that finds products with the highest comfort rating in\n",
    "each category:*\n",
    "\n",
    "WITH RankedComfort AS (\n",
    "\n",
    "SELECT\n",
    "\n",
    "\"Product Code\",\n",
    "\n",
    "\"Category\",\n",
    "\n",
    "\"Comfort\",\n",
    "\n",
    "ROW_NUMBER() OVER (PARTITION BY \"Category\" ORDER BY \"Comfort\" DESC) AS\n",
    "ComfortRank\n",
    "\n",
    "FROM Table3\n",
    "\n",
    ")\n",
    "\n",
    "SELECT \"Product Code\", \"Category\", \"Comfort\"\n",
    "\n",
    "FROM RankedComfort\n",
    "\n",
    "WHERE ComfortRank = 1;"
   ]
  }
 ],
 "nbformat": 4,
 "nbformat_minor": 5,
 "metadata": {}
}
